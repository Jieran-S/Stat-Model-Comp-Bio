setwd("~/Desktop/EthZ/Courses/Sem_4/Statistical_Model_CB/ExerGithub/Project_7_student")
margProb <- list()
margProb
margProb
margProb[[1]] <- c(2/3, 1/3)
margProb
library(data.table)
cluPotAry[["Psi12"]] <- data.table(c(1/5, 4/5), c(1/3, 2/3))
cliPotAry <- list()
cluPotAry[["Psi12"]] <- data.table(c(1/5, 4/5), c(1/3, 2/3))
cliPotAry <- list()
cluPotAry[["Psi12"]] <- data.table(c(1/5, 4/5), c(1/3, 2/3))
cliPotAry[["Psi12"]] <- data.table(c(1/5, 4/5), c(1/3, 2/3))
cliPotAry
cliPotAry[["Psi12"]] <- rbind(c(1/5, 4/5), c(1/3, 2/3))
cliPotAry
cliPotAry <- list()
cliPotAry[["Psi12"]] <- rbind(c(1/5, 4/5), c(1/3, 2/3))
cliPotAry[["Psi23"]] <- rbind(c(2/7, 5/7), c(2/3, 1/3))
cliPotAry[["Psi34"]] <- rbind(c(2/5, 3/5), c(3/5, 2/5))
cliPotAry[["Psi45"]] <- rbind(c(1/2, 1/2), c(1/2, 7/9))
cliPotAry
cliPotAry <- list()
cliPotAry[["Psi12"]] <- rbind(c(1/5, 4/5), c(1/3, 2/3))
cliPotAry[["Psi23"]] <- rbind(c(2/7, 5/7), c(2/3, 1/3))
cliPotAry[["Psi34"]] <- rbind(c(2/5, 3/5), c(3/5, 2/5))
cliPotAry[["Psi45"]] <- rbind(c(1/2, 1/2), c(2/9, 7/9))
cliPotAry
cliPotAry[[1]]*margProb[[1]]
cliPotAry[[3]]*margProb[[1]]
cliPotAry[[3]]
cliPotAry[[3]]*c(0.2,0.8)
colSums(cliPotAry[[3]]*c(0.2,0.8))
cliPotAry <- sapply(seq_along(cliPotAry),
function(ind){
cliPotAry[[ind]] <- cliPotAry[[ind]]*margProb[[ind]]
margProb[[ind+1]] <- colSums(cliPotAry[[ind]])
return(cliPotAry[[ind]])
},
simplify = FALSE,
USE.NAMES = names(cliPotAry))
cliPotAry <- sapply(seq_along(cliPotAry),
function(ind){
print(ind)
cliPotAry[[ind]] <- cliPotAry[[ind]]*margProb[[ind]]
margProb[[ind+1]] <- colSums(cliPotAry[[ind]])
return(cliPotAry[[ind]])
},
simplify = FALSE,
USE.NAMES = names(cliPotAry))
ind <- 2
print(ind)
cliPotAry[[ind]] <- cliPotAry[[ind]]*margProb[[ind]]
ind = 1
print(ind)
cliPotAry[[ind]] <- cliPotAry[[ind]]*margProb[[ind]]
margProb[[ind+1]] <- colSums(cliPotAry[[ind]])
margProb
cliPotAry <- sapply(seq_along(cliPotAry),
function(ind){
print(ind)
cliPotAry[[ind]] <- cliPotAry[[ind]]*margProb[[ind]]
margProb[[ind+1]] <- colSums(cliPotAry[[ind]])
return(cliPotAry[[ind]])
},
simplify = FALSE,
USE.NAMES = names(cliPotAry))
for (ind in seq_along(cliPotAry)) {
cliPotAry[[ind]]  <- cliPotAry[[ind]]*margProb[[ind]]
margProb[[ind+1]] <- colSums(cliPotAry[[ind]])
}
cliPotAry
margProb
print(cliPotAry)
cliPotAry <- list()
cliPotAry[["Psi12"]] <- rbind(c(1/5, 4/5), c(1/3, 2/3))
cliPotAry[["Psi23"]] <- rbind(c(2/7, 5/7), c(2/3, 1/3))
cliPotAry[["Psi34"]] <- rbind(c(2/5, 3/5), c(3/5, 2/5))
cliPotAry[["Psi45"]] <- rbind(c(1/2, 1/2), c(2/9, 7/9))
print(cliPotAry)
forwardMsg <- list()
forwardMsg[[1]] <- c(2/3, 1/3)
for (ind in seq_along(cliPotAry)) {
forwardMsg[[ind+1]] <- colSums(cliPotAry[[ind]]*margProb[[ind]])
}
print(forwardMsg)
margProb <- list()
margProb[[1]] <- c(2/3, 1/3)
cliPotAry <- list()
cliPotAry[["Psi12"]] <- rbind(c(1/5, 4/5), c(1/3, 2/3))
cliPotAry[["Psi23"]] <- rbind(c(2/7, 5/7), c(2/3, 1/3))
cliPotAry[["Psi34"]] <- rbind(c(2/5, 3/5), c(3/5, 2/5))
cliPotAry[["Psi45"]] <- rbind(c(1/2, 1/2), c(2/9, 7/9))
for (ind in seq_along(cliPotAry)) {
cliPotAry[[ind]]  <- cliPotAry[[ind]]*margProb[[ind]]
margProb[[ind+1]] <- colSums(cliPotAry[[ind]])
}
print(cliPotAry)
forwardMsg <- list()
forwardMsg[[1]] <- c(1,1)
for (ind in seq_along(cliPotAry)) {
forwardMsg[[ind+1]] <- colSums(cliPotAry[[ind]]*forwardMsg[[ind]])
}
print(forwardMsg)
?seq_along
backwardMsg <- forwardMsg
backwardMsg[[5]] <- c(1,1)
for (ind in rev(seq_along(cliPotAry))) {
backwardMsg[[ind-1]] <- colSums(cliPotAry[[ind]]*backwardMsg[[ind]])
}
print(forwardMsg)
forwardMsg <- list()
forwardMsg[[1]] <- c(1,1)
for (ind in seq_along(cliPotAry)) {
forwardMsg[[ind+1]] <- colSums(cliPotAry[[ind]]*forwardMsg[[ind]])
}
print(forwardMsg)
rev(seq_along(cliPotAry)
)
backwardMsg <- forwardMsg
backwardMsg[[5]] <- c(1,1)
for (ind in rev(seq_along(cliPotAry))+1) {
backwardMsg[[ind-1]] <- colSums(cliPotAry[[ind]]*backwardMsg[[ind]])
}
backwardMsg <- forwardMsg
backwardMsg[[5]] <- c(1,1)
for (ind in rev(seq_along(cliPotAry))) {
backwardMsg[[ind]] <- colSums(cliPotAry[[ind]]*backwardMsg[[ind+1]])
}
print(backwardMsg)
m1 <- rbind(c(1/2, 1/2), c(1/4, 3/4))
m1
c(1,2)*m1
c(1,2) %*% m1
m1 %*% c(1,2)
m1
t(m1) %*% c(1,2)
m1 %*% t(c(1,2))
backwardMsg <- forwardMsg
backwardMsg[[5]] <- c(1,1)
for (ind in rev(seq_along(cliPotAry))) {
backwardMsg[[ind]] <- t(t(cliPotAry[[ind]]) %*% backwardMsg[[ind+1]])
}
backwardMsg <- forwardMsg
backwardMsg[[5]] <- c(1,1)
backwardMsg <- forwardMsg
backwardMsg[[5]] <- c(1,1)
for (ind in rev(seq_along(cliPotAry))) {
backwardMsg[[ind]] <- t(cliPotAry[[ind]]) %*% backwardMsg[[ind+1]]
}
print(backwardMsg)
t(backwardMsg[[1]])
backwardMsg <- forwardMsg
backwardMsg[[5]] <- c(1,1)
for (ind in rev(seq_along(cliPotAry))) {
backwardMsg[[ind]] <- t(cliPotAry[[ind]]) %*% backwardMsg[[ind+1]]
backwardMsg[[ind]] <- t(backwardMsg[[ind]])
}
backwardMsg <- forwardMsg
backwardMsg[[5]] <- c(1,1)
for (ind in rev(seq_along(cliPotAry))) {
backwardMsg[[ind]] <- t(cliPotAry[[ind]]) %*% backwardMsg[[ind+1]]
backwardMsg[[ind]] <- t(backwardMsg[[ind]])
}
cliPotAry[[ind]]
for (ind in rev(seq_along(cliPotAry))) {
backwardMsg[[ind]] <- t(cliPotAry[[ind]]) %*% backwardMsg[[ind+1]]
backwardMsg[[ind]] <- t(backwardMsg[[ind]])
}
t(margProb[[ind]])
margProb[[ind]]
cliPotAry[[ind]]  <- cliPotAry[[ind]]*margProb[[ind]]
cliPotAry
backwardMsg <- forwardMsg
backwardMsg[[5]] <- c(1,1)
for (ind in rev(seq_along(cliPotAry))) {
backwardMsg[[ind]] <- t(cliPotAry[[ind]]) %*% backwardMsg[[ind+1]]
backwardMsg[[ind]] <- t(backwardMsg[[ind]])
}
backwardMsg[[ind+1]]
t(backwardMsg[[ind+1]])
m1
t(c(1,2))
c1 <- c(1,2)
m1 %*% c1
m1 %*% t(c1)
t(m1) %*% c1
backwardMsg <- forwardMsg
backwardMsg[[5]] <- c(1,1)
for (ind in rev(seq_along(cliPotAry))) {
backwardMsg[[ind]] <- t(cliPotAry[[ind]]) %*% t(backwardMsg[[ind+1]])
backwardMsg[[ind]] <- t(backwardMsg[[ind]])
}
rev(seq_along(cliPotAry)
)
backwardMsg <- forwardMsg
backwardMsg[[5]] <- c(1,1)
for (ind in rev(seq_along(cliPotAry))) {
backwardMsg[[ind]] <- t(cliPotAry[[ind]]) %*% backwardMsg[[ind+1]]
}
backwardMsg <- lapply(backwardMsg, t())
backwardMsg <- lapply(backwardMsg, t)
print(backwardMsg)
m1
c1
m1 %*% t(c1)
m1 %*% c1
c1 %*% t(m1)
backwardMsg <- forwardMsg
backwardMsg[[5]] <- c(1,1)
for (ind in rev(seq_along(cliPotAry))) {
backwardMsg[[ind]] <- backwardMsg[[ind+1]] %*% t(cliPotAry[[ind]])
}
print(backwardMsg)
print(backwardMsg)
backwardMsg <- forwardMsg
backwardMsg[[5]] <- c(1,1)
for (ind in rev(seq_along(cliPotAry))) {
backwardMsg[[ind]] <- backwardMsg[[ind+1]] %*% t(cliPotAry[[ind]])
}
print(backwardMsg)
